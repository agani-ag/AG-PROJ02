{% extends "mobile_v1/base.html" %}
{% load static %}
{% load humanize %}
{% block title %}Customer Home{% endblock %}

{% block content %}

<div class="row mt-3">
    <div class="col-12">
        <div class="card shadow-sm mb-3">

            <!-- Header -->
            <div class="card-header bg-success text-white d-flex align-items-center">
                <!-- <i class="fas fa-book fa-lg mr-2"></i> -->
                <h6 class="mb-0">
                    <span class="badge bg-dark text-light">Hi, Good Evening</span><br>
                    <span class="badge bg-light text-dark">{{ customer.customer_name|default:"Valued Customer"|upper }}</span>
                </h6>
            </div>
            
            <!-- Body -->
            <div class="card-body p-3">
                <div class="row">

                    <!-- Current Month Transactions -->
                    <div class="col-md-6">
                        <h6 class="mb-0">
                            <span class="badge bg-light text-dark">
                                Current Month Transactions ({% now "m/Y" %})
                            </span>
                        </h6>
                    </div>

                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body d-flex justify-content-between p-0">
                                <!-- First Total Purchased -->
                                <div class="card bg-danger text-white flex-fill m-1 text-center">
                                    <div class="card-body py-3">
                                        <h6 class="card-title"><i class="fas fa-receipt"></i> Purchased</h6>
                                        <h3>₹ {{ current_month_total_purchased | default:0 | intcomma }}</h3>
                                    </div>
                                </div>

                                <!-- Second Total Purchased -->
                                <div class="card bg-success text-white flex-fill m-1 text-center">
                                    <div class="card-body py-3">
                                        <h6 class="card-title"><i class="fas fa-check-circle"></i> Paid</h6>
                                        <h3>₹ {{ current_month_total_paid | default:0 | intcomma }}</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Last Month Transactions -->
                    <div class="col-md-6">
                        <h6 class="mb-0">
                            <span class="badge bg-light text-dark">
                                Last Month Transactions ({{ total_last_month_name }})
                            </span>
                        </h6>
                    </div>

                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-body d-flex justify-content-between p-0">
                                <!-- First Total Purchased -->
                                <div class="card bg-danger text-white flex-fill m-1 text-center">
                                    <div class="card-body py-3">
                                        <h6 class="card-title"><i class="fas fa-receipt"></i> Purchased</h6>
                                        <h3>₹ {{ last_month_total_purchased | default:0 | intcomma }}</h3>
                                    </div>
                                </div>

                                <!-- Second Total Purchased -->
                                <div class="card bg-success text-white flex-fill m-1 text-center">
                                    <div class="card-body py-3">
                                        <h6 class="card-title"><i class="fas fa-check-circle"></i> Paid</h6>
                                        <h3>₹ {{ last_month_total_paid | default:0 | intcomma }}</h3>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Global Transactions -->
                    <div class="col-md-6">
                        <h6 class="mb-0">
                            <span class="badge bg-light text-dark">
                                Global Transactions ({{ start_end_year }})
                            </span>
                        </h6>
                    </div>

                    <!-- Total Purchased -->
                    <div class="col-md-3 pb-2">
                        <div class="card bg-danger text-white">
                            <div class="card-body">
                                <h6 class="card-title"><i class="fas fa-receipt"></i> Total Purchased</h6>
                                <h3>₹ {{ total_purchased | default:0 | floatformat:2 | intcomma }}</h3>
                            </div>
                        </div>
                    </div>

                    <!-- Total Paid -->
                    <div class="col-md-3 pb-2">
                        <div class="card bg-success text-white">
                            <div class="card-body">
                                <h6 class="card-title"><i class="fas fa-check-circle"></i> Total Paid</h6>
                                <h3>₹ {{ total_paid | default:0 | floatformat:2 | intcomma }}</h3>
                            </div>
                        </div>
                    </div>

                    <!-- Total Returned -->
                    <div class="col-md-3 pb-2">
                        <div class="card bg-orange text-white">
                            <div class="card-body">
                                <h6 class="card-title"><i class="fas fa-reply"></i> Total Returned</h6>
                                <h3>₹ {{ total_returned | default:0 | floatformat:2 | intcomma }}</h3>
                            </div>
                        </div>
                    </div>

                    <!-- Total Others -->
                    <div class="col-md-3 pb-2">
                        <div class="card bg-violet text-white">
                            <div class="card-body">
                                <h6 class="card-title"><i class="fas fa-recycle"></i> Total Others</h6>
                                <h3>₹ {{ total_others | default:0 | floatformat:2 | intcomma }}</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="card-footer d-flex justify-content-between align-items-center">
                <div>
                    <i class="fas fa-building text-secondary"></i> 
                    <span class="mr-2 font-weight-bold">
                        {{ users.business_brand|default:"-"|upper }}
                    </span>
                </div>
                <div class="text-end">
                    <i class="fas fa-user-tag text-secondary"></i>
                    <span class="mr-2 text-muted font-weight-bold">
                        {{ customer.customer_userid|default:"-"|upper }}
                    </span>
                </div>
            </div>

        </div>
    </div>
</div>

{% endblock %}

{% block includejs %}
<script>
    function getGreeting() {
        const hour = new Date().getHours();
        let greeting = "Hello";
        if (hour >= 5 && hour < 12) {
            greeting = "Good Morning";
        } else if (hour >= 12 && hour < 17) {
            greeting = "Good Afternoon";
        } else if (hour >= 17 && hour < 21) {
            greeting = "Good Evening";
        } else {
            greeting = "Good Night";
        }
        document.getElementById("greeting").innerText = "Hi, " + greeting;
    }
    $(document).ready( function () {
        getGreeting();
    });
</script>
{% endblock %}
