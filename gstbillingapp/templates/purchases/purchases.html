{% extends "base.html" %}
{% load tz %}
{% load static %}
{% load humanize %}
{% block content %}

	<div>
		<div class="row mb-3">
			<div class="col-md-6">
				<h2>Purchases</h2>
			</div>
			<div class="col-md-6 text-right" style="margin-top: auto;">
				<a href="{% url 'purchases_add' %}" class="btn btn-primary btn-sm btn-curve">
					<i class="fas fa-plus"></i>
				</a>
				<a href="{% url 'feature_upload' %}" class="btn btn-success btn-sm btn-curve">
					<i class="fas fa-file-excel"></i>
				</a>
			</div>
		</div>
		
		<!-- Summary Cards -->
		<div class="row mb-3 p-0">
			<div class="col-md-4">
				<div class="card bg-danger text-white">
					<div class="card-body">
						<h6 class="card-title"><i class="fas fa-receipt"></i> Total Purchased</h6>
						<h3>₹ {{ total_p | default:0 | intcomma }}</h3>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card bg-success text-white">
					<div class="card-body">
						<h6 class="card-title"><i class="fas fa-check-circle"></i> Total Paid</h6>
						<h3>₹ {{ total_pp | default:0 | intcomma }}</h3>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card bg-orange text-white">
					<div class="card-body">
						<h6 class="card-title"><i class="fas fa-exclamation-triangle"></i> Balance Due</h6>
						<h3>₹ {{ total_pb | default:0 | intcomma }}</h3>
					</div>
				</div>
			</div>
		</div>

			<!-- <div class="col text-right" style="padding-top: 0.5%;">
				<a href="{% url 'purchases_add' %}" class="btn btn-primary btn-sm btn-curve">
					<i class="fas fa-plus"></i>
				</a>
				<a href="{% url 'feature_upload' %}" class="btn btn-success btn-sm btn-curve">
					<i class="fas fa-file-excel"></i>
				</a>
			</div> -->
	</div>

	<table class="table table-hover font-weight-bold" id="purchase-table">
		<thead class="thead-dark">
			<tr>
				<th>Date</th>
				<th>Type</th>
				<th>Amount</th>
				<th>Status</th>
				<th>Actions</th>
			</tr>
		</thead>
		<tbody class="two-col-form">
			{% for purchase in purchases %}
			<tr class="{% if purchase.amount > 0 %} table-success {% else %} table-danger {% endif %}">
 				<td>{{purchase.date|localtime|date:"M d, Y h:i A"}}</td>
				<td>{{purchase.get_ptype_display }}</td>
				<td>{% if purchase.amount %}₹ {{purchase.amount}}{% else %}<span class="text-muted">N/A</span>{% endif %}</td>
				<td>{{purchase.get_status_display}}</td>
				<td>
					<div class="btn-group" role="group" aria-label="Basic example">
						<a href="{% url 'purchases_edit' purchase.id %}" class="btn btn-primary btn-sm btn-curve"><i class="fas fa-edit"></i></a>
						<a href="{% url 'purchases_delete' purchase.id %}" class="btn btn-danger btn-sm btn-curve"><i class="fas fa-trash"></i></a>
					</div>
				</td>
			</tr>
			{% endfor %}
		</tbody>
	</table>
{% endblock %}


{% block includejs %}
<script type="text/javascript">
	$(document).ready( function () {
		$('#purchase-table').DataTable({
			"order": [],
			"columnDefs": [ {
				"targets": 3,
				"sortable": false,
				"searchable": false
			} ],
			"paging": true
		});
	});
</script>
{% endblock %}
